<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#0b1730" />
  <title>Typer PWA</title>
  <link rel="manifest" href="manifest.json" />
  <style>
    :root{
      --glass: rgba(9, 24, 52, 0.62);
      --glass2: rgba(9, 24, 52, 0.78);
      --stroke: rgba(255,255,255,0.10);
      --txt: rgba(255,255,255,0.92);
      --muted: rgba(255,255,255,0.65);
      --btn: rgba(255,255,255,0.10);
      --btn2: rgba(255,255,255,0.14);
      --shadow: 0 18px 60px rgba(0,0,0,0.35);
      --radius: 22px;
      --radius2: 16px;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--txt);
      background:#071225;
      overflow:hidden;
    }

    /* full background image */
    .bg{
      position:fixed; inset:0;
      background-position:center;
      background-size:cover;
      background-repeat:no-repeat;
      filter: saturate(1.05) contrast(1.02);
      transform: scale(1.02);
    }
    .vignette{
      position:fixed; inset:0;
      background: radial-gradient(ellipse at center, rgba(0,0,0,0.05) 0%, rgba(0,0,0,0.55) 70%, rgba(0,0,0,0.72) 100%);
      pointer-events:none;
    }

    /* screens */
    .screen{ position:fixed; inset:0; display:none; }
    .screen.active{ display:block; }

    /* splash */
    #splash{
      display:flex; align-items:center; justify-content:center;
      padding:18px;
    }
    .splashCard{
      width:min(980px, 96vw);
      height:min(560px, 92vh);
      border-radius: var(--radius);
      background: rgba(10, 18, 35, 0.35);
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow);
      overflow:hidden;
      display:flex;
      align-items:flex-end;
      justify-content:flex-start;
      position:relative;
    }
    .splashImg{
      position:absolute; inset:0;
      background-position:center;
      background-size:cover;
      background-repeat:no-repeat;
      filter: saturate(1.05) contrast(1.02);
    }
    .splashFooter{
      position:relative;
      width:100%;
      padding:14px 16px;
      display:flex;
      justify-content:space-between;
      gap:12px;
      background: linear-gradient(to top, rgba(0,0,0,0.52), rgba(0,0,0,0.00));
      font-size:12px;
      color: var(--muted);
    }

    /* common */
    .wrap{
      padding:18px;
      height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .card{
      width:min(1200px, 96vw);
      height:min(720px, 94vh);
      border-radius: var(--radius);
      background: rgba(10, 18, 35, 0.28);
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      position:relative;
    }
    .cardInner{
      padding:16px;
      display:flex;
      flex-direction:column;
      gap:12px;
      height:100%;
    }

    .topBar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:10px 12px;
      background: var(--glass);
      border: 1px solid var(--stroke);
      border-radius: 999px;
      width: fit-content;               /* <= pasek po LEWEJ, nie na całą szerokość */
      max-width: 100%;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 14px;
      border-radius: 999px;
      background: rgba(255,255,255,0.06);
      border: 1px solid var(--stroke);
      white-space:nowrap;
      font-weight:700;
    }
    .pill small{ font-weight:600; color: var(--muted); }
    .btn{
      border:1px solid var(--stroke);
      background: var(--btn);
      color: var(--txt);
      border-radius: 999px;
      padding:10px 14px;
      font-weight:700;
      cursor:pointer;
    }
    .btn:hover{ background: var(--btn2); }
    .btn:disabled{
      opacity:0.55;
      cursor:not-allowed;
    }

    .footerBar{
      padding:12px 14px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      color: var(--muted);
      font-size:12px;
      border-top: 1px solid rgba(255,255,255,0.08);
      background: rgba(0,0,0,0.10);
    }

    .grid2{
      display:grid;
      grid-template-columns: 1.35fr 0.85fr;
      gap:12px;
      height:100%;
      min-height:0;
    }
    .panel{
      background: var(--glass);
      border:1px solid var(--stroke);
      border-radius: var(--radius);
      padding:14px;
      min-height:0;
    }
    .panelTitle{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      margin-bottom:10px;
    }
    .panelTitle h2{
      margin:0;
      font-size:22px;
      letter-spacing:0.2px;
    }
    .panelTitle p{
      margin:4px 0 0 0;
      color: var(--muted);
      font-size:13px;
    }

    /* ROOM layout */
    .roomLayout{
      display:grid;
      grid-template-columns: 1.55fr 0.80fr; /* spotkania lewa kolumna szerzej */
      gap:12px;
      height:100%;
      min-height:0;
    }
    .leftCol{
      display:flex;
      flex-direction:column;
      gap:12px;
      min-height:0;
    }
    .rightCol{
      display:flex;
      flex-direction:column;
      gap:12px;
      min-height:0;
    }

    /* matches list full height */
    .matchesPanel{
      flex: 1;
      display:flex;
      flex-direction:column;
      min-height:0;
    }
    .matchesHeader{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
    }
    .matchesHeader .actions{
      display:flex; gap:10px; align-items:center;
    }
    .matchesList{
      flex:1;
      min-height:0;
      overflow:auto;
      padding-right:6px;
    }
    .matchRow{
      border:1px solid rgba(255,255,255,0.10);
      background: rgba(0,0,0,0.10);
      border-radius: 16px;
      padding:12px;
      margin-bottom:10px;
      display:grid;
      grid-template-columns: 1fr auto 1fr;
      align-items:center;
      gap:10px;
    }
    .team{
      display:flex;
      align-items:center;
      gap:10px;
      min-width:0;
    }
    .teamName{
      font-weight:800;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }
    .logo{
      width:28px; height:28px;
      border-radius:8px;
      background: rgba(255,255,255,0.08);
      border:1px solid rgba(255,255,255,0.10);
      object-fit:contain;
      flex:0 0 auto;
    }
    .scoreBox{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:8px;
    }
    .scoreInput{
      width:52px;
      padding:10px 10px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.08);
      color: var(--txt);
      font-weight:900;
      text-align:center;
      outline:none;
    }
    .scoreSep{ font-weight:900; opacity:0.9; }

    .hintLine{
      margin-top:6px;
      font-size:12px;
      color: var(--muted);
    }

    /* players panel */
    .playersList{
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .playerRow{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,0.10);
      background: rgba(0,0,0,0.10);
    }
    .playerRow b{ font-size:14px; }
    .playerRow span{ color: var(--muted); font-weight:700; }

    /* responsive phone */
    @media (max-width: 880px){
      .card{ height: 96vh; }
      .roomLayout{ grid-template-columns: 1fr; }
      .rightCol{ order:2; }
      .leftCol{ order:1; }
      .matchRow{ grid-template-columns: 1fr; gap:8px; }
      .scoreBox{ justify-content:flex-start; }
    }
  </style>
</head>
<body>
  <div id="bg" class="bg"></div>
  <div class="vignette"></div>

  <!-- SPLASH -->
  <div id="splash" class="screen active">
    <div class="splashCard">
      <div id="splashImg" class="splashImg"></div>
      <div class="splashFooter">
        <div id="splashHint">Ekran startowy (7s)…</div>
        <div id="splashVer"></div>
      </div>
    </div>
  </div>

  <!-- MENU (zostaje jak było – app.js nim zarządza) -->
  <div id="menuScreen" class="screen">
    <div class="wrap">
      <div class="card">
        <div class="cardInner">
          <div style="display:flex; gap:10px; align-items:center; justify-content:space-between;">
            <div class="topBar">
              <div class="pill">Menu</div>
              <div class="pill"><small>Nick:</small> <span id="nickText">—</span></div>
            </div>
            <div style="display:flex; gap:10px;">
              <button class="btn" id="changeNickBtn">Zmień nick</button>
            </div>
          </div>

          <div class="panel" style="flex:1; min-height:0; display:flex; align-items:center; justify-content:center;">
            <div style="display:flex; flex-direction:column; gap:14px; width:min(520px, 92vw);">
              <button class="btn" id="btnLiga" style="padding:16px 18px; font-size:16px;">Liga typerów</button>
              <button class="btn" id="btnStats" style="padding:16px 18px; font-size:16px;">Statystyki</button>
              <button class="btn" id="btnExit" style="padding:16px 18px; font-size:16px;">Wyjście</button>
            </div>
          </div>
        </div>

        <div class="footerBar">
          <div>Copyright 2026 RN_APS Mariusz Gębka</div>
          <div id="menuInfo">Menu gotowe.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- LIGA/POKOJE (ekran tworzenia/dołączania) -->
  <div id="roomsScreen" class="screen">
    <div class="wrap">
      <div class="card">
        <div class="cardInner">
          <div style="display:flex; gap:10px; align-items:center; justify-content:space-between;">
            <div class="topBar">
              <div class="pill">Liga</div>
              <div class="pill"><small>Nick:</small> <span id="nickTextRooms">—</span></div>
            </div>
            <div style="display:flex; gap:10px;">
              <button class="btn" id="changeNickBtnRooms">Zmień nick</button>
              <button class="btn" id="backToMenuBtn">Wróć</button>
            </div>
          </div>

          <div class="panel" style="flex:1; min-height:0; overflow:auto;">
            <div style="display:flex; flex-direction:column; gap:14px;">
              <div class="panel" style="border-radius:16px;">
                <div style="font-weight:900; font-size:22px; margin-bottom:10px;">Nowy pokój</div>
                <div style="display:flex; gap:10px; align-items:center;">
                  <input id="newRoomName" class="scoreInput" style="width:100%; text-align:left; font-weight:800;"
                         placeholder="Nazwa pokoju (np. Domek)" />
                  <button class="btn" id="createRoomBtn">Utwórz</button>
                </div>
                <div class="hintLine">Kod pokoju ma 6 znaków. Adminem będzie osoba, która tworzy pokój.</div>
              </div>

              <div class="panel" style="border-radius:16px;">
                <div style="font-weight:900; font-size:22px; margin-bottom:10px;">Dołącz do pokoju</div>
                <div style="display:flex; gap:10px; align-items:center;">
                  <input id="joinRoomCode" class="scoreInput" style="width:100%; text-align:left; font-weight:900; letter-spacing:1px;"
                         placeholder="Wpisz kod (np. AB12CD)" />
                  <button class="btn" id="joinRoomBtn">Dołącz</button>
                </div>
                <div class="hintLine">Uwaga: na razie pokoje są lokalne na urządzeniu (test).</div>
              </div>

              <div class="panel" style="border-radius:16px;">
                <div style="font-weight:900; font-size:18px; margin-bottom:10px;">Debug</div>
                <pre id="debugBox" style="margin:0; white-space:pre-wrap; color:rgba(255,255,255,0.78); font-size:12px;"></pre>
              </div>
            </div>
          </div>
        </div>

        <div class="footerBar">
          <div>Copyright 2026 RN_APS Mariusz Gębka</div>
          <div id="roomsInfo">—</div>
        </div>
      </div>
    </div>
  </div>

  <!-- ROOM -->
  <div id="roomScreen" class="screen">
    <div class="wrap">
      <div class="card">
        <div class="cardInner" style="gap:12px;">
          <!-- TOP BAR: po LEWEJ -->
          <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
            <div class="topBar">
              <div class="pill">Pokój</div>
              <div class="pill"><small>Nick:</small> <span id="nickTextRoom">—</span></div>
            </div>
            <button class="btn" id="roomBackBtn">Wróć</button>
          </div>

          <div class="roomLayout">
            <!-- LEFT: Spotkania -->
            <div class="leftCol">
              <div class="panel matchesPanel">
                <div class="matchesHeader">
                  <div>
                    <div style="font-size:22px; font-weight:900;">Spotkania</div>
                    <div class="hintLine">Typuj wyniki. Docelowo dojdzie import ligi/kolejki.</div>
                  </div>
                  <div class="actions">
                    <button class="btn" id="saveAllBtn" disabled>Zapisz typy</button>
                    <button class="btn" id="addQueueBtn">Dodaj kolejkę (test)</button>
                  </div>
                </div>

                <div id="matchesList" class="matchesList"></div>
              </div>
            </div>

            <!-- RIGHT: Gracze + Informacje -->
            <div class="rightCol">
              <div class="panel">
                <div class="panelTitle">
                  <div>
                    <h2>Gracze</h2>
                  </div>
                </div>
                <div id="playersList" class="playersList"></div>
              </div>

              <div class="panel">
                <div class="panelTitle">
                  <div>
                    <h2>Informacje</h2>
                  </div>
                </div>
                <div style="display:flex; flex-direction:column; gap:8px;">
                  <div style="font-size:22px; font-weight:900;" id="roomNameText">—</div>
                  <div style="color:var(--muted); font-weight:800;" id="roomAdminText">Admin: —</div>

                  <div style="display:flex; gap:10px; align-items:center; margin-top:8px;">
                    <div style="color:var(--muted); font-weight:800; min-width:90px;">Kod pokoju</div>
                    <input id="roomCodeText" class="scoreInput" style="width:100%; text-align:left; font-weight:900; letter-spacing:1px;" readonly />
                    <button class="btn" id="copyCodeBtn">Kopiuj</button>
                  </div>

                  <div style="display:flex; gap:10px; align-items:center; margin-top:8px;">
                    <button class="btn" id="leaveRoomBtn">Opuść pokój</button>
                    <button class="btn" id="refreshRoomBtn">Odśwież / napraw</button>
                  </div>

                  <div class="hintLine">Pokoje są lokalne (test). Następny krok: backend / współdzielenie.</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="footerBar">
          <div>Copyright 2026 RN_APS Mariusz Gębka</div>
          <div id="roomInfo">—</div>
        </div>
      </div>
    </div>
  </div>

  <script src="app.js?v=1013"></script>
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./sw.js").catch(()=>{});
    }
  </script>
</body>
</html>
