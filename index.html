<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#0b1730" />
  <title>Typer PWA</title>
  <link rel="manifest" href="manifest.json" />
  <style>
    :root{
      --glass: rgba(9, 24, 52, 0.68);
      --glass2: rgba(9, 24, 52, 0.78);
      --txt: rgba(255,255,255,0.92);
      --muted: rgba(255,255,255,0.65);
      --stroke: rgba(255,255,255,0.10);
      --btn: rgba(255,255,255,0.10);
      --btn2: rgba(255,255,255,0.16);
      --shadow: 0 18px 60px rgba(0,0,0,0.35);
      --radius: 22px;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--txt);
      background:#071225;
      overflow:hidden;
    }
    .bg{
      position:fixed; inset:0;
      background-position:center;
      background-size:cover;
      background-repeat:no-repeat;
      transform: scale(1.01);
      z-index:0;
    }
    .vignette{
      position:fixed; inset:0;
      background: radial-gradient(ellipse at center, rgba(0,0,0,0.05) 0%, rgba(0,0,0,0.55) 70%, rgba(0,0,0,0.72) 100%);
      pointer-events:none;
      z-index:1;
    }
    .screen{ position:fixed; inset:0; display:none; z-index:2; }
    .screen.active{ display:block; }

    /* SPLASH (bez obrazka) */
    #splash{ display:flex; align-items:center; justify-content:center; padding:12px; }
    .splashCard{
      width:min(1400px, 98vw);
      height:min(860px, 96vh);
      border-radius: var(--radius);
      background: rgba(10, 18, 35, 0.35);
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
      display:flex;
      align-items:flex-end;
    }
    .splashOverlay{
      position:absolute; inset:0;
      background: linear-gradient(to bottom, rgba(0,0,0,0.25), rgba(0,0,0,0.55));
    }
    .splashFooter{
      position:relative;
      width:100%;
      padding:14px 16px;
      display:flex;
      justify-content:space-between;
      gap:12px;
      font-size:12px;
      color: var(--muted);
    }

    /* KARTA */
    .wrap{
      padding:10px;
      height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .card{
      width:min(1500px, 99vw);
      height:min(900px, 96vh);
      border-radius: var(--radius);
      background: rgba(10, 18, 35, 0.28);
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow);
      overflow:hidden;
      display:flex;
      flex-direction:column;
    }
    .cardInner{
      padding:12px;
      display:flex;
      flex-direction:column;
      gap:10px;
      height:100%;
      min-height:0;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 14px;
      border-radius: 999px;
      background: rgba(255,255,255,0.06);
      border: 1px solid var(--stroke);
      white-space:nowrap;
      font-weight:800;
    }
    .pill small{ font-weight:700; color: var(--muted); }

    .btn{
      border:1px solid var(--stroke);
      background: var(--btn);
      color: var(--txt);
      border-radius: 999px;
      padding:10px 14px;
      font-weight:800;
      cursor:pointer;
    }
    .btn:hover{ background: var(--btn2); }
    .btn:disabled{ opacity:0.55; cursor:not-allowed; }

    .footerBar{
      padding:10px 14px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      color: var(--muted);
      font-size:12px;
      border-top: 1px solid rgba(255,255,255,0.08);
      background: rgba(0,0,0,0.10);
    }

    .panel{
      background: var(--glass);
      border:1px solid var(--stroke);
      border-radius: var(--radius);
      padding:14px;
      min-height:0;
    }
    .hintLine{ margin-top:6px; font-size:12px; color: var(--muted); }

    .scoreInput{
      width:52px;
      padding:10px 10px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.08);
      color: var(--txt);
      font-weight:900;
      text-align:center;
      outline:none;
    }

    /* ROOM: 3 kolumny */
    .roomFrame{
      flex:1;
      min-height:0;
      display:grid;
      grid-template-columns: 360px 1fr 360px;
      gap:12px;
    }

    .leftRail{
      background: var(--glass2);
      border:1px solid var(--stroke);
      border-radius: var(--radius);
      padding:14px;
      display:flex;
      flex-direction:column;
      gap:10px;
      align-items:stretch;
      min-height:0;
      overflow:auto;
    }

    .centerArea{
      background: var(--glass);
      border:1px solid var(--stroke);
      border-radius: var(--radius);
      padding:14px;
      display:flex;
      flex-direction:column;
      min-height:0;
    }

    .rightRail{
      background: var(--glass2);
      border:1px solid var(--stroke);
      border-radius: var(--radius);
      padding:14px;
      display:flex;
      flex-direction:column;
      gap:10px;
      min-height:0;
      overflow:auto;
    }

    .matchesHeader{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
    }
    .matchesList{
      flex:1;
      min-height:0;
      overflow:auto;
      padding-right:6px;
    }

    .matchRow{
      border:1px solid rgba(255,255,255,0.10);
      background: rgba(0,0,0,0.10);
      border-radius: 16px;
      padding:10px 12px;
      margin-bottom:10px;
      display:grid;
      grid-template-columns: 1fr auto 1fr;
      align-items:center;
      gap:10px;
    }

    .team{ display:flex; align-items:center; gap:10px; min-width:0; }
    .teamName{
      font-weight:800;
      font-size:14px;
      overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
    }
    .logo{
      width:26px; height:26px;
      border-radius:8px;
      background: rgba(255,255,255,0.08);
      border:1px solid rgba(255,255,255,0.10);
      object-fit:contain;
      flex:0 0 auto;
    }

    .scoreBox{ display:flex; align-items:center; justify-content:center; gap:8px; }
    .scoreSep{ font-weight:900; opacity:0.9; }

    .playersList{ display:flex; flex-direction:column; gap:10px; }
    .playerRow{
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      padding:10px 12px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,0.10);
      background: rgba(0,0,0,0.10);
    }
    .playerRow b{ font-size:14px; }
    .playerRow span{ color: var(--muted); font-weight:800; }

    .rowLine{
      display:flex; gap:10px; align-items:center; flex-wrap:wrap;
    }

    @media (max-width: 980px){
      .roomFrame{ grid-template-columns: 1fr; }
      .leftRail{ order:1; }
      .centerArea{ order:2; }
      .rightRail{ order:3; }
      .matchRow{ grid-template-columns: 1fr; }
      .scoreBox{ justify-content:flex-start; }
    }
  </style>
</head>
<body>
  <div id="bg" class="bg"></div>
  <div class="vignette"></div>

  <div id="splash" class="screen active">
    <div class="splashCard">
      <div class="splashOverlay"></div>
      <div class="splashFooter">
        <div id="splashHint">Ekran startowy (7s)…</div>
        <div id="splashVer"></div>
      </div>
    </div>
  </div>

  <div id="menuScreen" class="screen">
    <div class="wrap">
      <div class="card">
        <div class="cardInner">
          <div style="display:flex; gap:10px; align-items:center; justify-content:space-between;">
            <div style="display:flex; gap:10px; align-items:center;">
              <div class="pill">Menu</div>
              <div class="pill"><small>Nick:</small> <span id="nickText">—</span></div>
            </div>
            <div style="display:flex; gap:10px;">
              <button class="btn" id="changeNickBtn">Zmień nick</button>
            </div>
          </div>

          <div class="panel" style="flex:1; min-height:0; display:flex; align-items:center; justify-content:center;">
            <div style="display:flex; flex-direction:column; gap:14px; width:min(520px, 92vw);">
              <button class="btn" id="btnLiga" style="padding:16px 18px; font-size:16px;">Liga typerów</button>
              <button class="btn" id="btnStats" style="padding:16px 18px; font-size:16px;">Statystyki</button>
              <button class="btn" id="btnExit" style="padding:16px 18px; font-size:16px;">Wyjście</button>
            </div>
          </div>
        </div>

        <div class="footerBar">
          <div>Copyright 2026 RN_APS Mariusz Gębka</div>
          <div id="menuInfo">Menu gotowe.</div>
        </div>
      </div>
    </div>
  </div>

  <div id="roomsScreen" class="screen">
    <div class="wrap">
      <div class="card">
        <div class="cardInner">
          <div style="display:flex; gap:10px; align-items:center; justify-content:space-between;">
            <div style="display:flex; gap:10px; align-items:center;">
              <div class="pill">Liga</div>
              <div class="pill"><small>Nick:</small> <span id="nickTextRooms">—</span></div>
            </div>
            <div style="display:flex; gap:10px;">
              <button class="btn" id="changeNickBtnRooms">Zmień nick</button>
              <button class="btn" id="backToMenuBtn">Wróć</button>
            </div>
          </div>

          <div class="panel" style="flex:1; min-height:0; overflow:auto;">
            <div style="display:flex; flex-direction:column; gap:14px;">
              <div class="panel" style="border-radius:16px;">
                <div style="font-weight:900; font-size:22px; margin-bottom:10px;">Nowy pokój</div>
                <div style="display:flex; gap:10px; align-items:center;">
                  <input id="newRoomName" class="scoreInput" style="width:100%; text-align:left; font-weight:800;"
                         placeholder="Nazwa pokoju (np. Domek)" />
                  <button class="btn" id="createRoomBtn">Utwórz</button>
                </div>
                <div class="hintLine">Kod pokoju ma 6 znaków. Adminem będzie osoba, która tworzy pokój.</div>
              </div>

              <div class="panel" style="border-radius:16px;">
                <div style="font-weight:900; font-size:22px; margin-bottom:10px;">Dołącz do pokoju</div>
                <div style="display:flex; gap:10px; align-items:center;">
                  <input id="joinRoomCode" class="scoreInput" style="width:100%; text-align:left; font-weight:900; letter-spacing:1px;"
                         placeholder="Wpisz kod (np. AB12CD)" />
                  <button class="btn" id="joinRoomBtn">Dołącz</button>
                </div>
                <div class="hintLine">Uwaga: na razie pokoje są lokalne na urządzeniu (test).</div>
              </div>

              <div class="panel" style="border-radius:16px;">
                <div style="font-weight:900; font-size:18px; margin-bottom:10px;">Debug</div>
                <pre id="debugBox" style="margin:0; white-space:pre-wrap; color:rgba(255,255,255,0.78); font-size:12px;"></pre>
              </div>
            </div>
          </div>
        </div>

        <div class="footerBar">
          <div>Copyright 2026 RN_APS Mariusz Gębka</div>
          <div id="roomsInfo">—</div>
        </div>
      </div>
    </div>
  </div>

  <div id="roomScreen" class="screen">
    <div class="wrap">
      <div class="card">
        <div class="cardInner">
          <div class="roomFrame">

            <div class="leftRail">
              <div class="pill">Pokój</div>
              <div class="pill"><small>Nick:</small> <span id="nickTextRoom">—</span></div>

              <div class="panel" style="background:rgba(0,0,0,0.10); border-radius:16px;">
                <div style="font-size:20px; font-weight:900; margin-bottom:6px;" id="roomNameText">—</div>
                <div style="color:var(--muted); font-weight:900;" id="roomAdminText">Admin: —</div>

                <div class="rowLine" style="margin-top:10px;">
                  <div style="color:var(--muted); font-weight:900; min-width:60px;">Kod</div>
                  <input id="roomCodeText" class="scoreInput" style="width:100%; text-align:left; font-weight:900; letter-spacing:1px;" readonly />
                  <button class="btn" id="copyCodeBtn">Kopiuj</button>
                </div>

                <div class="rowLine" style="margin-top:10px;">
                  <button class="btn" id="leaveRoomBtn">Opuść</button>
                  <button class="btn" id="refreshRoomBtn">Odśwież</button>
                </div>

                <div class="hintLine" style="margin-top:10px;">
                  Pokoje są lokalne (test). Następny krok: backend / współdzielenie.
                </div>
              </div>

              <div class="panel" style="background:rgba(0,0,0,0.10); border-radius:16px;">
                <div style="font-weight:900; margin-bottom:8px;">Akcje</div>
                <div class="rowLine">
                  <button class="btn" id="saveAllBtn" disabled>Zapisz typy</button>
                  <button class="btn" id="addQueueBtn">Dodaj kolejkę (test)</button>
                </div>
                <div class="hintLine">Zapisz typy aktywuje się dopiero, gdy uzupełnisz wszystkie mecze.</div>
              </div>

              <button class="btn" id="roomBackBtn" style="margin-top:auto;">Wróć</button>
            </div>

            <div class="centerArea">
              <div class="matchesHeader">
                <div>
                  <div style="font-size:22px; font-weight:900;">Spotkania</div>
                  <div class="hintLine">Typuj wyniki. Docelowo dojdzie import ligi/kolejki.</div>
                </div>
              </div>
              <div id="matchesList" class="matchesList"></div>
            </div>

            <div class="rightRail">
              <div style="font-size:22px; font-weight:900;">Gracze</div>
              <div id="playersList" class="playersList"></div>
            </div>

          </div>
        </div>

        <div class="footerBar">
          <div>Copyright 2026 RN_APS Mariusz Gębka</div>
          <div id="roomInfo">—</div>
        </div>
      </div>
    </div>
  </div>

  <script src="app.js?v=1019"></script>
  <script>
    // Zostawiamy SW, ale i tak trzeba wyczyścić dane strony po błędzie (instrukcja niżej).
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./sw.js").catch(()=>{});
    }
  </script>
</body>
</html>
